{
  "info": {
    "_postman_id": "vortex-config-api",
    "name": "Vortex Config Server",
    "description": "API collection for Vortex Config Server - A Spring Cloud Config compatible configuration server written in Rust.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8888",
      "type": "string"
    },
    {
      "key": "app",
      "value": "user-service",
      "type": "string"
    },
    {
      "key": "profile",
      "value": "dev",
      "type": "string"
    },
    {
      "key": "label",
      "value": "main",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Health",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/health",
              "host": ["{{baseUrl}}"],
              "path": ["health"]
            },
            "description": "Check if the server is healthy and ready to serve requests."
          },
          "response": [
            {
              "name": "Healthy",
              "status": "OK",
              "code": 200,
              "body": "{\"status\":\"UP\"}"
            }
          ]
        }
      ]
    },
    {
      "name": "Configuration",
      "item": [
        {
          "name": "Basic Requests",
          "item": [
            {
              "name": "Get Config (app + profile)",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/{{app}}/{{profile}}",
                  "host": ["{{baseUrl}}"],
                  "path": ["{{app}}", "{{profile}}"]
                },
                "description": "Get configuration for an application with a specific profile. Uses default label (main)."
              }
            },
            {
              "name": "Get Config with Label",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/{{app}}/{{profile}}/{{label}}",
                  "host": ["{{baseUrl}}"],
                  "path": ["{{app}}", "{{profile}}", "{{label}}"]
                },
                "description": "Get configuration for an application with a specific profile and Git label (branch/tag)."
              }
            },
            {
              "name": "Get Config with Multiple Profiles",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/{{app}}/dev,prod",
                  "host": ["{{baseUrl}}"],
                  "path": ["{{app}}", "dev,prod"]
                },
                "description": "Get configuration combining multiple profiles. Profiles are merged in order (later profiles override earlier ones)."
              }
            }
          ]
        },
        {
          "name": "Output Formats",
          "item": [
            {
              "name": "Get Config as JSON",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/{{app}}/{{profile}}",
                  "host": ["{{baseUrl}}"],
                  "path": ["{{app}}", "{{profile}}"]
                },
                "description": "Get configuration in JSON format (default)."
              }
            },
            {
              "name": "Get Config as YAML",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/x-yaml",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/{{app}}/{{profile}}",
                  "host": ["{{baseUrl}}"],
                  "path": ["{{app}}", "{{profile}}"]
                },
                "description": "Get configuration in YAML format."
              }
            },
            {
              "name": "Get Config as Properties",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "text/plain",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/{{app}}/{{profile}}",
                  "host": ["{{baseUrl}}"],
                  "path": ["{{app}}", "{{profile}}"]
                },
                "description": "Get configuration in flat properties format (key=value)."
              }
            }
          ]
        },
        {
          "name": "Query Parameters",
          "item": [
            {
              "name": "Force Cache Refresh",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/{{app}}/{{profile}}?forceRefresh=true",
                  "host": ["{{baseUrl}}"],
                  "path": ["{{app}}", "{{profile}}"],
                  "query": [
                    {
                      "key": "forceRefresh",
                      "value": "true",
                      "description": "Bypass cache and fetch fresh configuration from Git"
                    }
                  ]
                },
                "description": "Force the server to bypass cache and fetch fresh configuration from the Git repository."
              }
            },
            {
              "name": "Use Default Label Fallback",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/{{app}}/{{profile}}/nonexistent-branch?useDefaultLabel=true",
                  "host": ["{{baseUrl}}"],
                  "path": ["{{app}}", "{{profile}}", "nonexistent-branch"],
                  "query": [
                    {
                      "key": "useDefaultLabel",
                      "value": "true",
                      "description": "Fall back to default label (main) if specified label doesn't exist"
                    }
                  ]
                },
                "description": "If the specified label (branch/tag) doesn't exist, fall back to the default label."
              }
            }
          ]
        },
        {
          "name": "User Service Examples",
          "item": [
            {
              "name": "user-service / default",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/user-service/default",
                  "host": ["{{baseUrl}}"],
                  "path": ["user-service", "default"]
                }
              }
            },
            {
              "name": "user-service / dev",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/user-service/dev",
                  "host": ["{{baseUrl}}"],
                  "path": ["user-service", "dev"]
                }
              }
            },
            {
              "name": "user-service / prod",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/user-service/prod",
                  "host": ["{{baseUrl}}"],
                  "path": ["user-service", "prod"]
                }
              }
            },
            {
              "name": "user-service / dev,prod (merged)",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/user-service/dev,prod",
                  "host": ["{{baseUrl}}"],
                  "path": ["user-service", "dev,prod"]
                },
                "description": "Merged configuration: prod profile overrides dev profile values."
              }
            },
            {
              "name": "user-service / dev / main",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/user-service/dev/main",
                  "host": ["{{baseUrl}}"],
                  "path": ["user-service", "dev", "main"]
                }
              }
            }
          ]
        },
        {
          "name": "Order Service Examples",
          "item": [
            {
              "name": "order-service / default",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/order-service/default",
                  "host": ["{{baseUrl}}"],
                  "path": ["order-service", "default"]
                }
              }
            },
            {
              "name": "order-service / dev",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/order-service/dev",
                  "host": ["{{baseUrl}}"],
                  "path": ["order-service", "dev"]
                }
              }
            },
            {
              "name": "order-service / dev (YAML)",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/x-yaml",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/order-service/dev",
                  "host": ["{{baseUrl}}"],
                  "path": ["order-service", "dev"]
                }
              }
            }
          ]
        },
        {
          "name": "Application (Global) Examples",
          "item": [
            {
              "name": "application / default",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/application/default",
                  "host": ["{{baseUrl}}"],
                  "path": ["application", "default"]
                },
                "description": "Get global application configuration (application.yml only)."
              }
            },
            {
              "name": "application / dev",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/application/dev",
                  "host": ["{{baseUrl}}"],
                  "path": ["application", "dev"]
                },
                "description": "Get global configuration with dev profile (application.yml + application-dev.yml)."
              }
            },
            {
              "name": "application / prod",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/application/prod",
                  "host": ["{{baseUrl}}"],
                  "path": ["application", "prod"]
                },
                "description": "Get global configuration with prod profile (application.yml + application-prod.yml)."
              }
            }
          ]
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "pm.test(\"Status code is 200\", function () {",
          "    pm.response.to.have.status(200);",
          "});",
          "",
          "pm.test(\"Response has name field\", function () {",
          "    if (pm.request.url.path.includes('health')) {",
          "        pm.expect(pm.response.json().status).to.eql('UP');",
          "    } else {",
          "        pm.expect(pm.response.json()).to.have.property('name');",
          "    }",
          "});"
        ]
      }
    }
  ]
}
